## 第4题

### 1.建表

```sql
##建立S表
CREATE TABLE S (SNO char(2) UNIQUE,SNAME char(6),STATUS char(2),CITY char(4));
##建立P表
CREATE TABLE P (PNO char(2) UNIQUE,PNAME char(6),COLOR char(2),WEIGHT INT);
##建立J表
CREATE TABLE J (JNO char(2) UNIQUE,JNAME char(6),CITY char(4));
##建立SPJ表
CREATE TABLE SPJ (SNO char(2),PNO char(2),JNO char(2),QTY INT);
```

### 2.查询

```sql
##供应工程J1零件的供应商号码SNO
SELECT SNO FROM SPJ WHERE JNO='J1';
##供应工程J1零件P1的供应商号码SNO
SELECT SNO FROM SPJ WHRER JNO='J1' AND PNO='P1';
##供应工程J1零件为红色的供应商号码SNO
SELECT SNO FROM SPJ,P WHERE JNO='J1' AND SPJ.PNO=P.PNO AND COLOR='红';
##没有使用天津供应商生产的红色零件的工程号JNO
SELECT JNO FROM SPJ WHRER JNO NOT IN(SELECT JNO FROM SPJ,P,S WHERE S.CITY='天津' AND COLOR='红' AND S.SNO=SPJ.SNO AND P.PNO=SPJ.PNO)
##至少用了供应商S1提供的全部零件的工程号JNO
SELECT DIST PNO FROM SPJ WHERE SNO='S1';
SELECT JNO FROM SPJ WHERE PNO='P1' AND JNO IN (SELECT JNO FROM SPJ WHERE PNO='P2');
```

## 第5题

```sql
##(1)
SELECT SNAME,CITY FROM S;
##(2)
SELECT PNAME,COLOR,WEIGHT FROM P;
##(3)
SELECT DIST JNO FROM SPJ WHERE SNO='S1';
##(4)
SELECT PNAME,QTY FROM SPJ,P WHERE P.PNO=SPJ.PNO AND SPJ.JNO='J2';
##(5)
SELECT PNO FROM SPJ,S WHERE S.SNO=SPJ.SNO AND CITY='上海';
##(6)
SELECT JNAME FROM SPJ,S,J WHERE S.SNO=SPJ.SNO AND S.CITY='上海' AND J.JNO=SPJ.JNO;
##(7)
SELECT DIST JNO FROM SPJ WHERE JNO NOT IN (SELECT DIST JNO FROM SPJ,S WHERE S.SNO=SPJ.SNO AND S.CITY='天津');
##(8)
UPDATE P SET COLOR='蓝' WHERE COLOR='红';
##(9)
UPDATE SPJ SET SNO='S3' WHERE SNO='S5' AND JNO='J4' AND PNO='P6';
##(10)
DELETE FROM S WHERE SNO='S2';
DELETE FROM SPJ WHERE SNO='S2';
##(11)
INSERT INTO SPJ VALUES('S2','J6','P4',200);
```